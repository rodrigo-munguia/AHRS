function [JHe]   =  JacH6b(x)

q1 = x(1);
q2 = x(2);
q3 = x(3);
q4 = x(4);



dh_dq1 = (2*q4)/(((2*q1*q4 - 2*q2*q3)^2/(2*q3^2 + 2*q4^2 - 1)^2 + 1)*(2*q3^2 + 2*q4^2 - 1));
dh_dq2 = -(2*q3)/(((2*q1*q4 - 2*q2*q3)^2/(2*q3^2 + 2*q4^2 - 1)^2 + 1)*(2*q3^2 + 2*q4^2 - 1));
dh_dq3 = -((2*q2)/(2*q3^2 + 2*q4^2 - 1) + (4*q3*(2*q1*q4 - 2*q2*q3))/(2*q3^2 + 2*q4^2 - 1)^2)/((2*q1*q4 - 2*q2*q3)^2/(2*q3^2 + 2*q4^2 - 1)^2 + 1);
dh_dq4 =  ((2*q1)/(2*q3^2 + 2*q4^2 - 1) - (4*q4*(2*q1*q4 - 2*q2*q3))/(2*q3^2 + 2*q4^2 - 1)^2)/((2*q1*q4 - 2*q2*q3)^2/(2*q3^2 + 2*q4^2 - 1)^2 + 1);


JHe = [dh_dq1 dh_dq2 dh_dq3 dh_dq4 0 0 0 0 0 0];